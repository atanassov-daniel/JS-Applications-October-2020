<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Movies</title>
    <link rel="icon" type="image/png" href="../static/favicon.ico">
    <link href="/static/css/site.css" type="text/css" rel="stylesheet">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
        integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.7.6/handlebars.min.js"></script>
    <script src="/scripts/services.js"></script>
    <script src="/scripts/router.js" defer></script>
    <script src="/scripts/init.js" defer></script><!-- init depends on services, so it should be put after it -->

</head>

<body>
    <div class="container" id="container">
        <div id="app"></div>

        <footer class="page-footer font-small">
            <div class="footer-copyright text-center py-3">Â© 2020
                <a href="https://softuni.bg/trainings/2840/js-applications-june-2020/internal" class="text-dark">JS
                    Applications</a>
            </div>
        </footer>
    </div>




    <script type="text/x-handlebars-template" id="notifications-template">
        <section class="notifications" id="errorBoxSection" style="display: none;">
            <p class="notification-message" id="errorBox"></p>
        </section>
        <section class="notifications" id="successBoxSection" style="display: none;background-color:rgba(1, 131, 29, 0.541);">
            <p class="notification-message" id="successBox"></p>
        </section>
    </script>

    <script type="text/x-handlebars-template" id="navigation-template">
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark" onclick="navigateHandler(event)">
            <a class="navbar-brand text-light nav-link" href="/">Movies</a>
            <ul class="navbar-nav ml-auto">
                {{#if isAuthenticated}}
                    <li class="nav-item">
                        <a class="nav-link">Welcome, {{email}}</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/logout">Logout</a>
                    </li>
                {{else}}
                    <li class="nav-item">
                        <a class="nav-link" href="/login">Login</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/register">Register</a>
                    </li>
                {{/if}}
            </ul>
        </nav>
    </script>

    <script type="text/x-handlebars-template" id="login-form-template">
        {{>navigation-template}}
        {{>notifications-template}}
        
        <form id="login-form" class="text-center border border-light p-5" onsubmit="onLoginSubmit(event)">
            <div class="form-group">
                <label for="email">Email</label>
                <input type="email" class="form-control" placeholder="Email" name="email" value="">
            </div>
            <div class="form-group">
                <label for="password">Password</label>
                <input type="password" class="form-control" placeholder="Password" name="password" value="">
            </div>
        
            <button type="submit" class="btn btn-primary">Login</button>
        </form>
    </script>

    <script type="text/x-handlebars-template" id="register-form-template">
        {{>navigation-template}}
        {{>notifications-template}}
        
        <form id="register-form" class="text-center border border-light p-5" onsubmit="onRegisterSubmit(event)">
            <div class="form-group">
                <label for="email">Email</label>
                <input type="email" class="form-control" placeholder="Email" name="email" value="">
            </div>
            <div class="form-group">
                <label for="password">Password</label>
                <input type="password" class="form-control" placeholder="Password" name="password" value="">
            </div>

            <div class="form-group">
                <label for="repeatPassword">Repeat Password</label>
                <input type="password" class="form-control" placeholder="Repeat-Password" name="repeatPassword"
                    value="">
            </div>

            <button type="submit" class="btn btn-primary">Register</button>
        </form>
    </script>

    <script type="text/x-handlebars-template" id="search-results-template">
        {{>navigation-template}}
        {{>notifications-template}}
        
        <h1 class="display-4">Search results for: <b>{{searchQuery}}</b></h1>
        <!-- <h1 class="text-center">Search results for: {{searchQuery}}</h1> -->

        <div class=" mt-3 ">
            <div class="row d-flex d-wrap">

                <div class="card-deck d-flex justify-content-center">
                    {{#each movies}}
                        {{>movie-card-template}}
                    {{else}}
                        <h5>No movies...</h5>
                    {{/each}}
                </div>

            </div>
        </div>
    </script>


    <script type="text/x-handlebars-template" id="home-template">
        {{>navigation-template}}
        {{>notifications-template}}
        
        <div class="jumbotron jumbotron-fluid text-light" style="background-color: #343a40;">
            <img src="https://s.studiobinder.com/wp-content/uploads/2019/06/Best-M-Night-Shyamalan-Movies-and-Directing-Style-StudioBinder.jpg"
                class="img-fluid" alt="Responsive image">
            <h1 class="display-4">Movies</h1>
            <p class="lead">Unlimited movies, TV shows, and more. Watch anywhere. Cancel anytime.</p>
        </div>

        {{#if isAuthenticated}}
        <h1 class="text-center">Movies</h1>
        <section>
            <a href="/addMovie" class="btn btn-warning" onclick="navigateHandler(event)">Add Movie</a>
            <form class="search float-right" onsubmit="onMovieSearchSubmit(event)">
                <label>Search: </label>
                <input type="text" id="search-text">
                <input type="submit" class="btn btn-info" value="Search">
            </form>
        </section>

        <div class=" mt-3 ">
            <div class="row d-flex d-wrap">

                <div class="card-deck d-flex justify-content-center">
                    {{#each movies}}
                        {{>movie-card-template}}
                    {{else}}
                        <h5>No movies...</h5>
                    {{/each}}
                </div>

            </div>
        </div>
        {{/if}}
    </script>

    <script type="text/x-handlebars-template" id="add-movie-template">
        {{>navigation-template}}
        {{>notifications-template}}
        
        <form id="add-movie-form" class="text-center border border-light p-5" onsubmit="onAddMovieSubmit(event)">
            <h1>Add Movie</h1>
            <div class="form-group">
                <label for="title">Movie Title</label>
                <input type="text" class="form-control" placeholder="Title" name="title" value="">
            </div>
            <div class="form-group">
                <label for="description">Movie Description</label>
                <textarea class="form-control" placeholder="Description" name="description"></textarea>
            </div>
            <div class="form-group">
                <label for="imageUrl">Image url</label>
                <input type="text" class="form-control" placeholder="Image Url" name="imageUrl" value="">
            </div>
            <button type="submit" class="btn btn-primary">Submit</button>
        </form>
    </script>

    <!-- <script type="text/x-handlebars-template" id="page-not-found-template">
        {{>navigation-template}}

        <h1>404</h1>
        <h1>Page Not Found</h1>

       <div> Maybe this page moved? Got deleted? Is hiding out in quarantine? Never existed in the first place?<p>Let's go <a href="#">home</a> and try from there.</p></div>
    </script> -->

    <script type="text/x-handlebars-template" id="page-not-found-template">
        {{>navigation-template}}

        <div class="mainbox" id="404-not-found">
            <div class="err">4</div>
            <div class="err2">0</div>
            <div class="err3">4</div>
            <div class="msg">Maybe this page moved? Got deleted? Is hiding out in quarantine? Never existed in the first place?<p>Let's go <a href="/">home</a> and try from there.</p></div>
        </div>

        <link rel="stylesheet" href="/static/css/404.css">
    </script>

    <script type="text/x-handlebars-template" id="forbidden-template">
        {{>navigation-template}}

        <div class="mainbox" id="404-not-found">
            <div class="err">4</div>
            <div class="err2">0</div>
            <div class="err3">3</div>
            <div class="msg">It appears you don't have permission to access this page! <br><br> <p>Let's go <a href="/">home</a> and try from there. <br> Alternatively, if you're a guest, please <a href="/login">login</a> or <a href="/register">register</a> and then try again!</p></div>
        </div>

        <link rel="stylesheet" href="/static/css/404.css">
    </script>

    <script type="text/x-handlebars-template" id="movie-card-template">
        <div class="card mb-4">
            <img class="card-img-top" src="{{imageUrl}}"
                alt="{{title}}" width="400">
            <div class="card-body">
                <h4 class="card-title">{{title}}</h4>
            </div>
            <div class="card-footer">
                <a href="/details/{{key}}"><button type="button"
                        class="btn btn-info details-button" onclick="navigateHandler(event)">Details</button></a>
            </div>
        </div>
    </script>

    <script type="text/x-handlebars-template" id="movie-details-template">
        {{>navigation-template}}
        {{>notifications-template}}
        
        <div class="container">
            <div class="row bg-light text-dark">
                <h1>Movie title: {{title}}</h1>

                <div class="col-md-8">
                    <img class="img-thumbnail" src="{{imageUrl}}"
                        alt="{{title}}">
                </div>
                <div class="col-md-4 text-center">
                    <h3 class="my-3 ">Movie Description</h3>
                    <p>{{description}}</p>
                    <!-- <a class="btn btn-danger" data-key="{{key}}" onclick="deleteMovie(event)">Delete</a> --> <!-- this one is for the first variant of the deleteMovie function, the bottom variant is better and is for the currently working deleteMovie function -->
                    {{#if isCreator}}
                        <a class="btn btn-danger" onclick="deleteMovie('{{key}}')">Delete</a>
                        <a class="btn btn-warning" href="/edit/{{key}}">Edit</a>
                    {{else}}
                        {{#if hasAlreadyLiked}}
                            <span class="enrolled-span" id="likes-count">Liked {{likesCount}}</span>
                        {{else}}
                            <a class="btn btn-primary" onclick="onMovieLike(event, '{{key}}')">Like</a>    
                        {{/if}}
                    {{/if}}
                </div>
            </div>
        </div>
    </script>

    <script type="text/x-handlebars-template" id="edit-movie-template">
        {{>navigation-template}}
        {{>notifications-template}}
        
        <form id="edit-movie-form" class="text-center border border-light p-5" onsubmit="onEditMovieSubmit(event, '{{key}}')">
            <h1>Edit Movie</h1>
            <div class="form-group">
                <label for="title">Movie Title</label>
                <input type="text" class="form-control" placeholder="Movie Title" value="{{title}}" name="title">
            </div>
            <div class="form-group">
                <label for="description">Movie Description</label>
                <textarea class="form-control" placeholder="Movie Description..." name="description">{{description}}</textarea>
            </div>
            <div class="form-group">
                <label for="imageUrl">Image url</label>
                <input type="text" class="form-control" placeholder="Image Url" value="{{imageUrl}}" name="imageUrl">
            </div>
            <button type="submit" class="btn btn-primary">Submit</button>
        </form>
    </script>

</body>

</html>